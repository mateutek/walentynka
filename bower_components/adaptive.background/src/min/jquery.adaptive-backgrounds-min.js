!function($){var n="data-ab-color",t="data-ab-parent",a="data-ab-css-background",e="ab-color-found",r={selector:"[data-adaptive-background]",parent:null,exclude:["rgb(0,0,0)","rgba(255,255,255)"],normalizeTextColor:!1,normalizedTextColors:{light:"#fff",dark:"#000"},lumaClasses:{light:"ab-light",dark:"ab-dark"}};!function(n,t){"use strict";var a=function(){return document.createElement("canvas").getContext("2d")},e=function(n,t){var e=new Image,r=n.src||n;"data:"!==r.substring(0,5)&&(e.crossOrigin="Anonymous"),e.onload=function(){var n=a();n.drawImage(e,0,0);var r=n.getImageData(0,0,e.width,e.height);t&&t(r.data)},e.src=r},r=function(n){return["rgb(",n,")"].join("")},o=function(n){return n.map(function(n){return r(n.name)})},c=5,i=10,u={};u.colors=function(n,a){a=a||{};var u=a.exclude||[],s=a.paletteSize||i;e(n,function(e){for(var i=n.width*n.height||e.length,l={},d="",f=[],m={dominant:{name:"",count:0},palette:Array.apply(null,new Array(s)).map(Boolean).map(function(n){return{name:"0,0,0",count:0}})},g=0;i>g;)if(f[0]=e[g],f[1]=e[g+1],f[2]=e[g+2],d=f.join(","),-1===f.indexOf(t)){if(d in l?l[d]=l[d]+1:l[d]=1,-1===u.indexOf(r(d))){var p=l[d];p>m.dominant.count?(m.dominant.name=d,m.dominant.count=p):m.palette.some(function(n){return p>n.count?(n.name=d,n.count=p,!0):void 0})}g+=4*c}else g+=4*c;if(a.success){var v=o(m.palette);a.success({dominant:r(m.dominant.name),secondary:v[0],palette:v})}})},n.RGBaster=n.RGBaster||u}(window),$.adaptiveBackground={run:function(o){var c=$.extend({},r,o);$(c.selector).each(function(r,o){var i=$(this),u=function(){var t=s()?l():i[0];RGBaster.colors(t,{paletteSize:20,exclude:c.exclude,success:function(t){console.log(t),i.attr(n,t.dominant),i.trigger(e,{color:t.dominant,palette:t.palette})}})},s=function(){var n=i.attr(a);return"undefined"!=typeof n&&n!==!1},l=function(){var n=i.css("background-image"),t=/\(([^)]+)\)/,a=t.exec(n)[1].replace(/"/g,"");return a};i.on(e,function(n,a){var e;e=c.parent&&i.parents(c.parent).length?i.parents(c.parent):i.attr(t)&&i.parents(i.attr(t)).length?i.parents(i.attr(t)):s()?i:c.parent?i.parents(c.parent):i.parent(),e.css({backgroundColor:a.color});var r=function(n){var t=a.color.match(/\d+/g);return(299*t[0]+587*t[1]+114*t[2])/1e3},o=function(n){return r(n)>=128?c.normalizedTextColors.dark:c.normalizedTextColors.light},u=function(n){return r(n)<=128?c.lumaClasses.dark:c.lumaClasses.light};c.normalizeTextColor&&e.css({color:o(a.color)}),e.addClass(u(a.color)).attr("data-ab-yaq",r(a.color)),c.success&&c.success(i,a)}),u()})}}}(jQuery);